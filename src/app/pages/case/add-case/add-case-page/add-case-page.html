<section class="section">
    <h3>Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø¹Ù…ÙŠÙ„</h3>
    <div class="search-box">
        <form #searchForm="ngForm" (ngSubmit)="search(natId, natIdModel?.invalid!)">
            <div class="row g-3">
                <div class="col-md-10">
                    <input type="text" name="natid" [(ngModel)]="natId" #natIdModel="ngModel"
                        [class.border-error]="(natIdModel.invalid) && showNatBoxErrors" required maxlength="10"
                        pattern="^\d{10}$" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ© Ù„Ù„Ø¨Ø­Ø«" class="form-control" />
                </div>
                <div class="col-md-2">
                    <input type="submit" value="Ø¨Ø­Ø«" class="btn bg-sub w-fill" />
                </div>
            </div>
            @if (natIdModel.invalid && showNatBoxErrors) {
            <div class="errors" animate.enter="error-animation">
                @if (natIdModel.errors?.['required']) {
                <p>ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ©</p>
                }
                @if (natIdModel.errors?.['pattern']) {
                <p>Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ© ÙŠØ¬Ø¨ Ø£Ù† ÙŠØªÙƒÙˆÙ† Ù…Ù† 10 Ø®Ø§Ù†Ø§Øª</p>
                }
            </div>
            }
        </form>
        @if ((addCaseForm.value.existingClients?.length) || (addCaseForm.value.newClients?.length)) {
        <div class="parties-container">
            <p>Ø£Ø·Ø±Ø§Ù Ø§Ù„Ù‚Ø¶ÙŠØ© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©:</p>
            <div class="row g-3 mt-3">
                @for(client of addCaseForm.value.existingClients; track idx; let idx = $index) {
                <div class="parties client-id  myrow col-12">
                    <p class="flex">Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ©: {{client.natId}}</p>
                    <button class="btn-del" (click)="deleteExistingClient(idx)"><i
                            class="fa-solid fa-xmark"></i></button>
                </div>
                }

                @for(client of addCaseForm.value.newClients; track client.person?.natId; let i = $index) {
                <div class="parties client-id  myrow col-12">
                    <p class="flex">Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ©: {{client?.person?.natId}}</p>
                    <button class="btn-del" (click)="deleteNewClient(i)"><i class="fa-solid fa-xmark"></i></button>
                </div>
                }
            </div>
        </div>
        }
        <p class="txt">ğŸ’¡ Ø¥Ø°Ø§ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù…ÙŠÙ„ØŒ Ø³ØªÙØªØ­ Ù†Ø§ÙØ°Ø© Ù„Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙŠÙ„ Ø¬Ø¯ÙŠØ¯</p>
    </div>
</section>
<form [formGroup]="addCaseForm">
    <section formGroupName="case" class="section">
        <h3>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù‚Ø¶ÙŠØ©</h3>
        <div class="row g-3">
            <div class="col-md-6">
                <label class="form-label">Ù…ÙˆØ¶ÙˆØ¹ Ø§Ù„Ù‚Ø¶ÙŠØ©</label>
                <input type="text" formControlName="subject" placeholder="Ø£Ø¯Ø®Ù„ Ù…ÙˆØ¶ÙˆØ¹ Ø§Ù„Ù‚Ø¶ÙŠØ©"
                    [class.border-error]="(addCaseForm.controls.case.controls.subject.touched && addCaseForm.controls.case.controls.subject.invalid)"
                    class="form-control" />

                @if (addCaseForm?.controls?.case?.controls?.subject?.touched) {
                <div class="errors" animate.enter="error-animation">
                    @if (addCaseForm.controls?.case?.controls?.subject?.errors?.['required']) {
                    <p>Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ù…Ø·Ù„ÙˆØ¨</p>
                    }
                    @if (addCaseForm.controls?.case?.controls?.subject?.errors?.['minlength']) {
                    <p>ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ 3 Ø£Ø­Ø±Ù</p>
                    }
                </div>
                }
            </div>

            <div class="col-md-6">
                <label class="form-label">Ø§Ø·Ø±Ø§Ù Ø§Ù„Ø¯Ø¹ÙˆÙ‰</label>
                <select formControlName="partiesToTheCase"
                    [class.border-error]="(addCaseForm.controls.case.controls.partiesToTheCase.touched && addCaseForm.controls.case.controls.partiesToTheCase.invalid)"
                    class="form-control">
                    <option value="Ù…Ø¯Ø¹ÙŠ">Ù…Ø¯Ø¹ÙŠ</option>
                    <option value="Ù…Ø¯Ø¹ÙŠ Ø¹Ù„ÙŠÙ‡">Ù…Ø¯Ø¹ÙŠ Ø¹Ù„ÙŠÙ‡</option>
                </select>
                @if (addCaseForm.controls?.case?.controls?.partiesToTheCase?.touched) {
                <div class="errors" animate.enter="error-animation">
                    @if (addCaseForm.controls?.case?.controls?.partiesToTheCase?.errors?.['required']) {
                    <p>Ù‡Ø§Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ù…Ø·Ù„ÙˆØ¨</p>
                    }
                </div>
                }
            </div>

            <div class="col-md-6">
                <label class="form-label">Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªÙˆÙ‚Ø¹ Ù„Ù„Ø¯Ø±Ø§Ø³Ø©</label>
                <input type="date" formControlName="estimatedTime"
                    [class.border-error]="(addCaseForm.controls.case.controls.estimatedTime.touched && addCaseForm.controls.case.controls.estimatedTime.invalid)"
                    class="form-control" />

                @if (addCaseForm.controls?.case?.controls?.estimatedTime?.touched) {
                <div class="errors" animate.enter="error-animation">
                    @if (addCaseForm.controls?.case?.controls?.estimatedTime?.errors?.['required']) {
                    <p>ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ØªØ§Ø±ÙŠØ®</p>
                    }
                    @if (addCaseForm.controls?.case?.controls?.estimatedTime?.errors?.['pastDate']) {
                    <p>Ø§Ø¯Ø®Ù„ ÙˆÙ‚Øª ÙÙŠ Ø§Ù„Ø­Ø§Ø¶Ø± Ø§Ùˆ Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„</p>
                    }
                </div>
                }
            </div>

            <div class="col-md-6">
                <label class="form-label">Ù†ÙˆØ¹ Ø§Ù„Ù…Ø­ÙƒÙ…Ø©</label>
                <select formControlName="courtType"
                    [class.border-error]="(addCaseForm.controls.case.controls.courtType.touched && addCaseForm.controls.case.controls.courtType.invalid)"
                    class="form-select">
                    @for (court of courts; track court.courtTypeId; let first = $first) {
                    <option selected [value]="court.courtTypeId">{{court.name}}</option>
                    }
                </select>
                @if (addCaseForm.controls?.case?.controls?.courtType?.touched) {
                <div class="errors" animate.enter="error-animation">
                    @if (addCaseForm.controls?.case?.controls?.courtType?.errors?.['required']) {
                    <p>Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ù…Ø·Ù„ÙˆØ¨</p>
                    }
                </div>
                }
            </div>

            <div class="col-md-6">
                <label class="form-label">Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ù…ÙˆÙƒÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù‚Ø¶ÙŠØ©</label>
                <select formControlName="assignedOfficer" class="form-select"
                    [class.border-error]="(addCaseForm.controls.case.controls.assignedOfficer.touched && addCaseForm.controls.case.controls.assignedOfficer.invalid)">
                    @for (em of employeeNames; track em.id) {
                    <option [value]="em.id">{{em.name}}</option>
                    }
                </select>
                @if (addCaseForm.controls?.case?.controls?.assignedOfficer?.touched) {
                <div class="errors" animate.enter="error-animation">
                    @if (addCaseForm.controls?.case?.controls?.assignedOfficer?.errors?.['required']) {
                    <p>Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ù…Ø·Ù„ÙˆØ¨</p>
                    }
                </div>
                }
            </div>

            <div class="col-md-6">
                <label class="form-label">Ø±Ù‚Ù… Ø§Ù„Ù‚Ø¶ÙŠØ©</label>
                <input type="text" formControlName="caseNumber" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‚Ø¶ÙŠØ©"
                    [class.border-error]="(addCaseForm.controls.case.controls.caseNumber.touched && addCaseForm.controls.case.controls.caseNumber.invalid)"
                    class="form-control" />

                @if (addCaseForm.controls?.case?.controls?.caseNumber?.touched) {
                <div class="errors" animate.enter="error-animation">
                    @if (addCaseForm.controls?.case?.controls?.caseNumber?.errors?.['required']) {
                    <p>Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ù…Ø·Ù„ÙˆØ¨</p>
                    }
                </div>
                }
            </div>

            <div class="col-12">
                <label class="form-label">Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„</label>
                <textarea formControlName="clientRequests"
                    [class.border-error]="(addCaseForm.controls.case.controls.clientRequests.touched && addCaseForm.controls.case.controls.clientRequests.invalid)"
                    placeholder="Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„" class="form-control"></textarea>

                @if (addCaseForm.controls?.case?.controls?.clientRequests?.touched) {
                <div class="errors" animate.enter="error-animation">
                    @if (addCaseForm.controls?.case?.controls?.clientRequests?.errors?.['required']) {
                    <p>Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ù…Ø·Ù„ÙˆØ¨</p>
                    }
                </div>
                }
            </div>

            <div class="col-12 lawyer-opnion">
                <label class="form-label">Ø±Ø£ÙŠ Ø§Ù„Ù…Ø­Ø§Ù…ÙŠ</label>
                <textarea formControlName="lawyerOpinion"
                    [class.border-error]="(addCaseForm.controls.case.controls.lawyerOpinion.touched && addCaseForm.controls.case.controls.lawyerOpinion.invalid)"
                    placeholder="Ø±Ø£ÙŠ Ø§Ù„Ù…Ø­Ø§Ù…ÙŠ" class="form-control"></textarea>

                @if (addCaseForm.controls?.case?.controls?.lawyerOpinion?.touched) {
                <div class="errors" animate.enter="error-animation">
                    @if (addCaseForm.controls?.case?.controls?.lawyerOpinion?.errors?.['required']) {
                    <p>Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ù…Ø·Ù„ÙˆØ¨</p>
                    }
                    @if (addCaseForm.controls?.case?.controls?.lawyerOpinion?.errors?.['minlength']) {
                    <p>ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ 10 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„</p>
                    }
                </div>
                }
            </div>
        </div>
    </section>

    <div class="btn-group" role="group" aria-label="Buttons Action group">
        <button type="submit" (click)="submit(false)" class="btn bg-sub">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©</button>
        <button type="submit" (click)="submit(true)" class="btn bg-accent">Ø­ÙØ¸ ÙƒÙ…Ø³ÙˆØ¯Ø©</button>
    </div>
</form>